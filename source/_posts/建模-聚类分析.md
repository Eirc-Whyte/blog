---
title: 建模-聚类分析
date: 2020-08-19 20:08:52
tags:
- 聚类分析
categories:
- 数学建模
---

### 聚类

聚类分析是一种定量方法，从数据的角度，对样本或指标进行**分类**，进而进行更好的分析。

<!--more-->

从分类对象上分为两种：

- Q型聚类（clustering for individuals 分类样本）

- R型聚类（clustering for variables 分类变量）

> ​       Q型是对样本进行分类处理，其作用在于:
>
> 1.能利用多个变量对样本进行分类；
>
> 2.分类结果直观，聚类谱系图能明确、清楚地表达其数值分类结果；
>
> 3.所得结果比传统的定性分类方法更细致、全面、合理。
>
>   R型是对变量进行分类处理，其作用在于：
>
> 1.可以了解变量间及变量组合间的亲疏关系；
>
> 2.可以根据变量的聚类结果及它们之间的关系，**选择主要变量进行回归分析或Q型聚类分析。**

#### Q型聚类

##### 样本距离(样本的相似性度量)

常用的有绝对值距离、欧氏距离。使用欧氏距离必须标准化处理，但避免不了变量的多重相关性。因而多使用**马氏距离（ Mahalanobis）**：
$$
d(x,y) = \sqrt{(x-y)^T\Sigma^{-1}(x-y)}
$$
式子中，x、y是来自**总体Z**两个样本（向量）。**∑是Z的协方差矩阵。**

此外，还可采用**样本相关系数**、**夹角余弦**和其它关联性度量作为相似性度量。

##### 类与类之间的相似性度量

1. 由一个样品组成的类是最基本的类。**如果每一类都由一个样品组成，那么样品间的距离就是类间距离**。

2. 如果某一类包含不止一个样品，那么就要确定类间距离，类间距离是基于样品间距离定义的。如果有两个样本类G1和G2，我们可以用下面的一系列方法度量它们间的距离：

   1. **最短距离法（nearest neighbor or single linkage method）**
      ![在这里插入图片描述](https://img-blog.csdnimg.cn/20191122211518476.png)
      它的直观意义为**两个类中最近两点间的距离**。

   2. **最长距离法（farthest neighbor or complete linkage method）**

      ![在这里插入图片描述](https://img-blog.csdnimg.cn/20191122211643222.png)
      它的直观意义为**两个类中最远两点间的距离**。

   3. **重心法（centroid method）**
      ![在这里插入图片描述](https://img-blog.csdnimg.cn/20191122211818433.png)

   4. **类平均法（group average method）**
      ![在这里插入图片描述](https://img-blog.csdnimg.cn/20191122230321400.png)
      它等于**G1 ,G2中两两样本点距离的平均**，式中n1 , n2 分别为G1 ,G2中的样本点个数。

   5. **离差平方和法（sum of squares method）**
      ![在这里插入图片描述](https://ericblog.oss-cn-beijing.aliyuncs.com/img/20191122230534393.png)
      事实上，若 G1 ,G2内部点与点距离很小，则它们能很好地各自聚为一类，并且这两类又能够充分分离（即D12很大），这时必然有D = D12 − D1 − D2 很大。因此，按定义可以认为，两类G1 ,G2之间的距离很大。

##### Q型聚类步骤：

- 1 ）计算n个样本点两两之间的距离dij ，记为矩阵D = （dij）（n*n）； 
- 2）首先构造n个类，每一个类中只包含一个样本点，每一类的平台高度均为零
- 3）合并距离近的两类为新类，并且以这两类间的距离值作为聚类图中的平台高 度；
- 4）计算新类与当前各类的距离，若类的个数已经等于 1，转入步骤 5），否则，回 到步骤 3）；
- 5）画聚类图；
- 6）决定类的个数和类。

##### Matlab函数

![image](https://ericblog.oss-cn-beijing.aliyuncs.com/img/1044022-20180726113134285-1767678002.png)

![image](https://ericblog.oss-cn-beijing.aliyuncs.com/img/1044022-20180726113139323-51889137.png)

![image](https://ericblog.oss-cn-beijing.aliyuncs.com/img/1044022-20180726113150230-342000996.png)

![image](https://ericblog.oss-cn-beijing.aliyuncs.com/img/1044022-20180726113153287-734469306.png)

![image](https://ericblog.oss-cn-beijing.aliyuncs.com/img/1044022-20180726113155248-1472626612.png)

#### R型聚类

R型聚类是更常用的。**影响指标有若干，但这些影响因素（自变量）之间可能有相关性，把比较相关的聚成一类，只选用其中的一个因素来代表该类，从而对问题做出简化。**

##### 两类之间的距离

![image-20200819202919480](https://ericblog.oss-cn-beijing.aliyuncs.com/img/image-20200819202919480.png)

**r为相关系数。**这些操作都是**基于相关系数**的。

### 例子：

#### Q型聚类

![image-20200819203025856](https://ericblog.oss-cn-beijing.aliyuncs.com/img/image-20200819203025856.png)

```matlab
clc,clear
 a = [1,0;1,1;3,2;4,3;2,5];
 y = pdist(a,'cityblock') %计算绝对值距离
yc = squareform(y);
 z = linkage(y) %最短距离法产生聚类树

[h,t] = dendrogram(z) %画聚类图命令
T = cluster(z,'maxclust',3) %把对象划分为3类
for i = 1:3
     tm = find(T == i);%返回第i类对象
     tm = reshape(tm,1,length(tm));%编程行向量
     fprintf('第%d类对象有%s\n',i,int2str(tm));
 end
```

#### R型聚类

![image-20200819203121095](https://ericblog.oss-cn-beijing.aliyuncs.com/img/image-20200819203121095.png)

先提供相关系数矩阵（）

```matlab
clc,clear
 a = textread('ch.txt')
 d = 1 - abs(a); %相关系数转距离
d = tril(d); %提出d矩阵的下三角部分
b = nonzeros(d);%去掉d的0
 b = b';
 z = linkage(b,'complete') %最大距离,产生聚类树
y = cluster(z,'maxclust',2) %变量分为2类
ind1 = find(y == 1);
 ind1 = ind1'
 ind2 = find(y == 2);
 ind2 = ind2'
 dendrogram(z) %画聚类图
```

![image-20200819203202614](https://ericblog.oss-cn-beijing.aliyuncs.com/img/image-20200819203202614.png)